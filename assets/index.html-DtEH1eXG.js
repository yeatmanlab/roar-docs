import{_ as n,c as a,f as e,o as t}from"./app-BcJZ6spU.js";const p={};function o(l,s){return t(),a("div",null,s[0]||(s[0]=[e(`<h1 id="data-cleaning" tabindex="-1"><a class="header-anchor" href="#data-cleaning"><span>Data Cleaning</span></a></h1><p>This section walks through the standards and steps of cleaning ROAR data.</p><h2 id="general-guidelines" tabindex="-1"><a class="header-anchor" href="#general-guidelines"><span>General Guidelines</span></a></h2><p>The following steps describe typical cleaning procedures of any ROAR Data (run- or trial-level).</p><ol><li>Removing extra characters (&quot;\\&quot;, &quot;[]&quot;, etc.) from the assinging_orgs variables (assinging_classes, assigning_schools, assigning_districts, assigning_groups, assigning_families). Removing these extra characters will help when merging with the organization key that matches organization ids to their names.</li></ol><div class="language-r line-numbers-mode" data-highlighter="prismjs" data-ext="r" data-title="r"><pre><code><span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span></span>
<span class="line">  mutate<span class="token punctuation">(</span>assigning_districts <span class="token operator">=</span> str_remove_all<span class="token punctuation">(</span>assigning_districts<span class="token punctuation">,</span> </span>
<span class="line">                                              <span class="token string">&quot;[\\\\[\\\\]\\\\\\&quot;\\\\\\\\]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  mutate<span class="token punctuation">(</span>assigning_schools <span class="token operator">=</span> str_remove_all<span class="token punctuation">(</span>assigning_schools<span class="token punctuation">,</span> </span>
<span class="line">                                              <span class="token string">&quot;[\\\\[\\\\]\\\\\\&quot;\\\\\\\\]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  mutate<span class="token punctuation">(</span>assigning_classes <span class="token operator">=</span> str_remove_all<span class="token punctuation">(</span>assigning_classes<span class="token punctuation">,</span> </span>
<span class="line">                                              <span class="token string">&quot;[\\\\[\\\\]\\\\\\&quot;\\\\\\\\]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  mutate<span class="token punctuation">(</span>assigning_groups <span class="token operator">=</span> str_remove_all<span class="token punctuation">(</span>assigning_groups<span class="token punctuation">,</span> </span>
<span class="line">                                              <span class="token string">&quot;[\\\\[\\\\]\\\\\\&quot;\\\\\\\\]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  mutate<span class="token punctuation">(</span>assigning_families <span class="token operator">=</span> str_remove_all<span class="token punctuation">(</span>assigning_families<span class="token punctuation">,</span> </span>
<span class="line">                                              <span class="token string">&quot;[\\\\[\\\\]\\\\\\&quot;\\\\\\\\]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>Substituting empty string (&quot;&quot;) values within the dataframe to be NA values for easier database wrangling and filtering.</li></ol><div class="language-r line-numbers-mode" data-highlighter="prismjs" data-ext="r" data-title="r"><pre><code><span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  mutate_if<span class="token punctuation">(</span>is.character<span class="token punctuation">,</span> list<span class="token punctuation">(</span><span class="token operator">~</span>na_if<span class="token punctuation">(</span>.<span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>Remove columns that have all NA values. There are many columns within the ROAR dataframes that only apply to specific assessments. Removing the columns that are all NA, removes columns that are unneccessary for the current assessment.</li></ol><div class="language-r line-numbers-mode" data-highlighter="prismjs" data-ext="r" data-title="r"><pre><code><span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  select<span class="token punctuation">(</span>where<span class="token punctuation">(</span><span class="token operator">~</span> <span class="token operator">!</span>all<span class="token punctuation">(</span>is.na<span class="token punctuation">(</span>.<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>Remove duplicate rows. Sometimes during merging, BigQuery will accidentally maintain duplicate or identical rows. Removing them ensures the researcher is accurately counting each unique student, run, or trial.</li></ol><div class="language-r line-numbers-mode" data-highlighter="prismjs" data-ext="r" data-title="r"><pre><code><span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  distinct<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li>Remove test, demo, QA, pilot, and <strong>opt-out</strong> student accounts. Test aaccounts are often created for the interal developers and partnerships teams to test the assessments for correct features and outputs. Demo accounts are often created for organization administrators to explore ROAR and determine if the assessments are fitting for their students. QA accounts are often created for the QA testers to test any changes across the different variants or updates to the dashboard. Pilot accounts are typically created for school districts that are running a small set of students to determine if ROAR is a good fit for their organization. Opt-out accounts are students who have taken ROAR and their data will be used by the school, but their parents/guardians have opted out their data from research use and purposes.</li></ol><div class="language-r line-numbers-mode" data-highlighter="prismjs" data-ext="r" data-title="r"><pre><code><span class="line"><span class="token comment"># remove using is_test and is_demo </span></span>
<span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  filter<span class="token punctuation">(</span>is_demo_data<span class="token operator">==</span><span class="token string">&quot;false&quot;</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  filter<span class="token punctuation">(</span>is_test_data<span class="token operator">==</span><span class="token string">&quot;false&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># remove test, zzz, qa, demo assessment_pid </span></span>
<span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span></span>
<span class="line">  filter<span class="token punctuation">(</span><span class="token operator">!</span>str_detect<span class="token punctuation">(</span>tolower<span class="token punctuation">(</span>assessment_pid<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;zzz|test|demo|qa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> </span>
<span class="line"></span>
<span class="line"><span class="token comment"># remove opt-outs </span></span>
<span class="line"><span class="token comment"># https://drive.google.com/file/d/1s85ydQm8MUSJrb3ZAag_G7z6iMitd4it/view?usp=drive_link -&gt; opt out csv </span></span>
<span class="line">opt.out.csv <span class="token operator">&lt;-</span> <span class="token string">&quot;opt_outs_2025-11-05.csv&quot;</span> </span>
<span class="line">opt.out <span class="token operator">&lt;-</span> read.csv<span class="token punctuation">(</span>file.path<span class="token punctuation">(</span>getwd<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;data&#39;</span><span class="token punctuation">,</span> opt.out.csv<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  filter<span class="token punctuation">(</span><span class="token operator">!</span>assessment_pid <span class="token percent-operator operator">%in%</span> opt.out<span class="token operator">$</span>assessment_pid<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># remove known test districts  </span></span>
<span class="line"><span class="token comment"># known assigning_districts used for testing</span></span>
<span class="line">test_districts <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">&quot;kXyCT8BbFFbuXo5u0M84&quot;</span><span class="token punctuation">)</span> <span class="token comment"># MB Demo District</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># known assigning_groups used for testing</span></span>
<span class="line">test_groups <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">&quot;xCfln1aBgGISoxhRhwax&quot;</span><span class="token punctuation">,</span> <span class="token comment"># blank</span></span>
<span class="line">                <span class="token string">&quot;yettgcgO25iX1uupiEgw&quot;</span><span class="token punctuation">,</span> <span class="token comment"># Test Group</span></span>
<span class="line">                <span class="token string">&quot;v1B0A4BY7uVQt4YwEMod&quot;</span><span class="token punctuation">,</span> <span class="token comment"># LEVANTE-CORE-TASKS-TEST</span></span>
<span class="line">                <span class="token string">&quot;S91j0taJd1rXCEXhbSnB&quot;</span><span class="token punctuation">,</span> <span class="token comment"># zzzTG</span></span>
<span class="line">                <span class="token string">&quot;7dX5tAGAFXkdwQ4idPms&quot;</span><span class="token punctuation">,</span> <span class="token comment"># aerdf Demo</span></span>
<span class="line">                <span class="token string">&quot;X7GFqFVDyLFDdun4TqP7&quot;</span> <span class="token comment"># Kyle Test Group</span></span>
<span class="line">                <span class="token punctuation">)</span></span>
<span class="line">  </span>
<span class="line"><span class="token comment"># demo and test schools</span></span>
<span class="line">test_schools <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">&quot;03xEaKoFXSe6QSvNe5Q2&quot;</span><span class="token punctuation">,</span> <span class="token comment"># demo</span></span>
<span class="line">                 <span class="token string">&quot;61e9fd89d016951095f43c65&quot;</span><span class="token punctuation">,</span> <span class="token comment"># Clever Demo Bayview</span></span>
<span class="line">                 <span class="token string">&quot;61e9fd89d016951095f43c68&quot;</span><span class="token punctuation">,</span> <span class="token comment"># Clever Demo Westwood</span></span>
<span class="line">                 <span class="token string">&quot;G2mM3eEwDPZU3h2A4ikZ&quot;</span><span class="token punctuation">,</span> <span class="token comment"># Mia test</span></span>
<span class="line">                 <span class="token string">&quot;RgrPvxn5kkKSal6wdpQy&quot;</span><span class="token punctuation">,</span> <span class="token comment"># ROAR Demo</span></span>
<span class="line">                 <span class="token string">&quot;RqAKFNEVjBrZXvSE7OsC&quot;</span><span class="token punctuation">,</span> <span class="token comment"># SM Demo</span></span>
<span class="line">                 <span class="token string">&quot;rZRPSq6IfUOkAQM2mecC&quot;</span> <span class="token comment"># MB Demo School</span></span>
<span class="line">                 <span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># remove known test id&#39;s</span></span>
<span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  filter<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>assigning_districts <span class="token percent-operator operator">%in%</span> test_districts<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  filter<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>assigning_groups <span class="token percent-operator operator">%in%</span> test_groups<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  filter<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>assigning_schools <span class="token percent-operator operator">%in%</span> test_schools<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="6"><li>Remove NA values in assessment_pid. assessment_pid is the unique identifying variable that can link the run-level, trial-level, and demographic information for each student. Without it, the scores are not useful.</li></ol><div class="language-r line-numbers-mode" data-highlighter="prismjs" data-ext="r" data-title="r"><pre><code><span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  filter<span class="token punctuation">(</span><span class="token operator">!</span>is.na<span class="token punctuation">(</span>assessment_pid<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="7"><li><strong>There is an active issue with grade. The grades for students prior to 24-25 school year were updated to be the current grade despite when the run was logged. Therefore, we have to use age_in_months_at_run to estimate grade for students who&#39;s grades were incorrectly upgraded to the current school year&#39;s grade.</strong> In addition, to fixing the grade issue with estimation, researchers also have to clean up the values of the grades so they follow a unique pattern (e.g., K, Kinder, Kindergarten all represent the same thing).</li></ol><div class="language-r line-numbers-mode" data-highlighter="prismjs" data-ext="r" data-title="r"><pre><code><span class="line"><span class="token comment"># remove NA age months </span></span>
<span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span></span>
<span class="line">  filter<span class="token punctuation">(</span><span class="token operator">!</span>is.na<span class="token punctuation">(</span>age_months_at_run<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># clean up grade </span></span>
<span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span></span>
<span class="line">  muate<span class="token punctuation">(</span>user_grade_at_run <span class="token operator">=</span> case_when<span class="token punctuation">(</span></span>
<span class="line">    user_grade_at_run <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">&quot;Kindergarten&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;K&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Kindergarden&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;k&quot;</span><span class="token punctuation">)</span> <span class="token operator">~</span> <span class="token string">&quot;Kindergarten&quot;</span><span class="token punctuation">,</span> </span>
<span class="line">    user_grade_at_run <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1st&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;01&quot;</span><span class="token punctuation">)</span> <span class="token operator">~</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> </span>
<span class="line">    user_grade_at_run <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2nd&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;02&quot;</span><span class="token punctuation">)</span> <span class="token operator">~</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> </span>
<span class="line">    user_grade_at_run <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3rd&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;03&quot;</span><span class="token punctuation">)</span> <span class="token operator">~</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span> </span>
<span class="line">    user_grade_at_run <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">&quot;4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;4th&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;04&quot;</span><span class="token punctuation">)</span> <span class="token operator">~</span> <span class="token string">&quot;4&quot;</span><span class="token punctuation">,</span> </span>
<span class="line">    user_grade_at_run <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">&quot;5&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;5th&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;05&quot;</span><span class="token punctuation">)</span> <span class="token operator">~</span> <span class="token string">&quot;5&quot;</span><span class="token punctuation">,</span> </span>
<span class="line">    user_grade_at_run <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">&quot;6&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;6th&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;06&quot;</span><span class="token punctuation">)</span> <span class="token operator">~</span> <span class="token string">&quot;6&quot;</span><span class="token punctuation">,</span> </span>
<span class="line">    user_grade_at_run <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">&quot;7&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;7th&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;07&quot;</span><span class="token punctuation">)</span> <span class="token operator">~</span> <span class="token string">&quot;7&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    user_grade_at_run <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">&quot;8&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;8th&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;08&quot;</span><span class="token punctuation">)</span> <span class="token operator">~</span> <span class="token string">&quot;8&quot;</span><span class="token punctuation">,</span> </span>
<span class="line">    user_grade_at_run <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">&quot;9&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;9th&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;09&quot;</span><span class="token punctuation">)</span> <span class="token operator">~</span> <span class="token string">&quot;9&quot;</span><span class="token punctuation">,</span> </span>
<span class="line">    user_grade_at_run <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">&quot;10&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;10th&quot;</span><span class="token punctuation">)</span> <span class="token operator">~</span> <span class="token string">&quot;10&quot;</span><span class="token punctuation">,</span> </span>
<span class="line">    user_grade_at_run <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">&quot;11&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;11th&quot;</span><span class="token punctuation">)</span> <span class="token operator">~</span> <span class="token string">&quot;11&quot;</span><span class="token punctuation">,</span> </span>
<span class="line">    user_grade_at_run <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">&quot;12&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;12th&quot;</span><span class="token punctuation">)</span> <span class="token operator">~</span> <span class="token string">&quot;12&quot;</span><span class="token punctuation">,</span> </span>
<span class="line">    user_grade_at_run <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">&quot;Invalid&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Other&quot;</span><span class="token punctuation">)</span> <span class="token operator">~</span> <span class="token keyword">NA</span><span class="token punctuation">,</span> </span>
<span class="line">    user_grade_at_run <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">&quot;PK&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Pre-k&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Pre-K&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pre-k&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pre-kindergarten&quot;</span><span class="token punctuation">)</span> <span class="token operator">~</span> <span class="token string">&quot;Pre-K&quot;</span><span class="token punctuation">,</span> </span>
<span class="line">    <span class="token boolean">TRUE</span> <span class="token operator">~</span> user_grade_at_run </span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  mutate<span class="token punctuation">(</span>user_grade_at_run <span class="token operator">=</span> ifelse<span class="token punctuation">(</span><span class="token operator">!</span>user_grade_at_run <span class="token percent-operator operator">%in%</span> </span>
<span class="line">                                      c<span class="token punctuation">(</span><span class="token string">&quot;Pre-K&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Kindergarten&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;5&quot;</span><span class="token punctuation">,</span> </span>
<span class="line">                                        <span class="token string">&quot;6&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;7&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;8&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;9&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;10&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;11&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;12&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> </span>
<span class="line">                                    <span class="token keyword">NA</span><span class="token punctuation">,</span> user_grade_at_run<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># create a function to estimate grade based on age_months_at_run </span></span>
<span class="line"><span class="token comment"># estimate grade for anyone before 24-25 school year because of known grade issue </span></span>
<span class="line">estimate_grade <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>age_months<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment"># Determine the grade based on age in months</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>age_months <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment"># Less than 5 years old</span></span>
<span class="line">    return<span class="token punctuation">(</span><span class="token string">&quot;Pre-K&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>age_months <span class="token operator">&gt;=</span> <span class="token number">60</span> <span class="token operator">&amp;&amp;</span> age_months <span class="token operator">&lt;</span> <span class="token number">72</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment"># 5 years old to (but not including) 6 years old</span></span>
<span class="line">    return<span class="token punctuation">(</span><span class="token string">&quot;Kindergarten&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>age_months <span class="token operator">&gt;=</span> <span class="token number">72</span> <span class="token operator">&amp;&amp;</span> age_months <span class="token operator">&lt;</span> <span class="token number">216</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment"># From 6 years old to (but not including) 18 years old</span></span>
<span class="line">    return<span class="token punctuation">(</span>as.character<span class="token punctuation">(</span>floor<span class="token punctuation">(</span>age_months <span class="token operator">/</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Grade 1 through 12</span></span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">    return<span class="token punctuation">(</span><span class="token string">&quot;12&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># 18 years and older</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  mutate<span class="token punctuation">(</span>user_grade_at_run <span class="token operator">=</span> ifelse<span class="token punctuation">(</span>time_started <span class="token operator">&lt;</span> as.Date<span class="token punctuation">(</span><span class="token string">&quot;2024-07-31&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> </span>
<span class="line">                             map_chr<span class="token punctuation">(</span>age_months_at_run<span class="token punctuation">,</span> estimate_grade<span class="token punctuation">)</span><span class="token punctuation">,</span> </span>
<span class="line">                             user_grade_at_run<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># estimate grade for anyone with missing grade </span></span>
<span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  mutate<span class="token punctuation">(</span>user_grade_at_run <span class="token operator">=</span> ifelse<span class="token punctuation">(</span>is.na<span class="token punctuation">(</span>user_grade_at_run<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                             map_chr<span class="token punctuation">(</span>age_months_at_run<span class="token punctuation">,</span> estimate_grade<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                             user_grade_at_run<span class="token punctuation">)</span><span class="token punctuation">)</span>                                    </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="trial-level" tabindex="-1"><a class="header-anchor" href="#trial-level"><span>Trial-level</span></a></h2><p>The following steps describe the typical cleaning procedures of ROAR trial-level data.</p><ol><li>Remove duplicate trial ids. In the trial-level dataframes, trial ids exist to uniquely identify the specific trial within the specific run that the student responded to. Ensuring uniqueness of trials ensures the accurate count of unique trials and the number of trials completed within a run.</li></ol><div class="language-r line-numbers-mode" data-highlighter="prismjs" data-ext="r" data-title="r"><pre><code><span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  distinct<span class="token punctuation">(</span>trial_id<span class="token punctuation">,</span> .keep_all <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>Depending on the analyses, researchers will often want to remove practice trials from their analyses so they can isolate test responses.</li></ol><div class="language-r line-numbers-mode" data-highlighter="prismjs" data-ext="r" data-title="r"><pre><code><span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span></span>
<span class="line">  filter<span class="token punctuation">(</span>assessment_stage<span class="token operator">==</span><span class="token string">&quot;test_response&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="run-level" tabindex="-1"><a class="header-anchor" href="#run-level"><span>Run-level</span></a></h2><p>The following steps describe the typical cleaning procesdures of ROAR run-level data.</p><ol><li>Filter clean runs. For each of the ROAR assessments, the runs are cleaned using a combination of the following variables: completed, best_run, reliable. For all assessments, completed is used to determine if the student finished the assessment. For core assessment, best_run and reliable are used to determine if the student answered the items in a plausible and reliable way. For the non-core assessments, best_run and reliable are not active features.</li></ol><div class="language-r line-numbers-mode" data-highlighter="prismjs" data-ext="r" data-title="r"><pre><code><span class="line"><span class="token comment"># keep completed runs (non-core assessments) </span></span>
<span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  filter<span class="token punctuation">(</span>completed<span class="token operator">==</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span> </span>
<span class="line"></span>
<span class="line"><span class="token comment"># keep completed, best, and reliable runs (core assessments) </span></span>
<span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  filter<span class="token punctuation">(</span>best_run<span class="token operator">==</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span></span>
<span class="line">  filter<span class="token punctuation">(</span>completed<span class="token operator">==</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  filter<span class="token punctuation">(</span>reliable <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># for older core runs, reliable was set to NA for when it was not an active feature </span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>Remove NA values for scores. There could be a variety of reasons for NA scores: incomplete assessments, error in data logging, etc. These rows are not useful for analyses and could create issues in modeling moving forward.</li></ol><div class="language-r line-numbers-mode" data-highlighter="prismjs" data-ext="r" data-title="r"><pre><code><span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  filter<span class="token punctuation">(</span><span class="token operator">!</span>is.na<span class="token punctuation">(</span>computed.composite.score<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>Remove duplicate run ids. In the run-level dataframes, run ids exist to uniquely identify the specific run that the student completed. Ensuring uniqueness of runs ensures the accurate count of unique runs and the number of runs completed for each student.</li></ol><div class="language-r line-numbers-mode" data-highlighter="prismjs" data-ext="r" data-title="r"><pre><code><span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  distinct<span class="token punctuation">(</span>run_id<span class="token punctuation">,</span> .keep_all <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><em>Optional</em>: Keep only the one run for students who have run more than once. For some analyses, it may be important to only count each student once. The two most common ways to achieve this is to keep the first run or the most recent run for students who have multiple runs of the same assessment.</p><div class="language-r line-numbers-mode" data-highlighter="prismjs" data-ext="r" data-title="r"><pre><code><span class="line"><span class="token comment"># Keep the first run for students who have run more than once on an assessment </span></span>
<span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span></span>
<span class="line">  mutate<span class="token punctuation">(</span>time_started <span class="token operator">=</span> ymd_hms<span class="token punctuation">(</span>time_started<span class="token punctuation">,</span> tz <span class="token operator">=</span> <span class="token string">&quot;UTC&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  group_by<span class="token punctuation">(</span>assessment_pid<span class="token punctuation">,</span> task_id<span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  filter<span class="token punctuation">(</span>n<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">|</span> time_started <span class="token operator">==</span> min<span class="token punctuation">(</span>time_started<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">$</span><span class="token operator">&gt;</span><span class="token operator">$</span> </span>
<span class="line">  ungroup<span class="token punctuation">(</span><span class="token punctuation">)</span> </span>
<span class="line"></span>
<span class="line"><span class="token comment"># Keep the most recent run for students who have run more than once on an assessment </span></span>
<span class="line">df <span class="token operator">&lt;-</span> df <span class="token percent-operator operator">%&gt;%</span></span>
<span class="line">  mutate<span class="token punctuation">(</span>time_started <span class="token operator">=</span> ymd_hms<span class="token punctuation">(</span>time_started<span class="token punctuation">,</span> tz <span class="token operator">=</span> <span class="token string">&quot;UTC&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  group_by<span class="token punctuation">(</span>assessment_pid<span class="token punctuation">,</span> task_id<span class="token punctuation">)</span> <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  filter<span class="token punctuation">(</span>n<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">|</span> time_started <span class="token operator">==</span> max<span class="token punctuation">(</span>time_started<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">$</span><span class="token operator">&gt;</span><span class="token operator">$</span> </span>
<span class="line">  ungroup<span class="token punctuation">(</span><span class="token punctuation">)</span> </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="bigquery-demographics" tabindex="-1"><a class="header-anchor" href="#bigquery-demographics"><span>BigQuery Demographics</span></a></h2><p>The demographics data can be difficult to wrangle for many reasons. Like most demographics data, there are opportunities for participants and researchers to enter data through open text boxes or drop downs with infinite options. Particularly, the race and ethnicity variables are often times filled with typing errors, grammatical errors, varying cases, and a variety of outcomes. The researcher will want to clean these variables and all other demographic variables to capture all the information they can while creating a concise and clean dataframe.</p><ol><li>Filter only student demographics. Across Clever and ClassLink, BigQuery stores demographic information for students, teachers, and administrators. Researchers likely only care about the student demographic data.</li></ol><div class="language-r line-numbers-mode" data-highlighter="prismjs" data-ext="r" data-title="r"><pre><code><span class="line">demo <span class="token operator">&lt;-</span> demo <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  filter<span class="token punctuation">(</span>user_type<span class="token operator">==</span><span class="token string">&quot;student&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>Remove duplicate assessment pids. In the demographic dataframe, assessment pids exist to uniquely identify the specific student and the demographics assigned to them. The demographics are not stored longitudinally, therefore, there shouldn&#39;t be repeat pids.</li></ol><div class="language-r line-numbers-mode" data-highlighter="prismjs" data-ext="r" data-title="r"><pre><code><span class="line">demo <span class="token operator">&lt;-</span> demo <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  distinct<span class="token punctuation">(</span>assessment_pid<span class="token punctuation">,</span> .keep_all <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><p>Create uniform values for the demographic variables:</p><ul><li>Gender</li><li>English Language Learner Status</li><li>Free/Reduced Lunch Status</li><li>IEP Status</li><li>Hispanic Ethnicity</li><li>Race</li><li>Home Language</li></ul></li></ol><p>See <a href="https://github.com/yeatmanlab/Clean-ROAR-Data/blob/main/Clean_Demographics.Rmd" target="_blank" rel="noopener noreferrer">Clean_Demographics.Rmd</a> for details on cleaning.</p><p><em>Optional</em>: Remove grade variables. Researchers will likely want to use the user_grade_at_run variable to assign grade to each student in the assessment-level dataframes. However, if they are solely looking at demographics of students who are linked to ROAR, then they can keep the grade variable.</p><div class="language-r line-numbers-mode" data-highlighter="prismjs" data-ext="r" data-title="r"><pre><code><span class="line">demo <span class="token operator">&lt;-</span> demo <span class="token percent-operator operator">%&gt;%</span> </span>
<span class="line">  select<span class="token punctuation">(</span><span class="token operator">-</span>grade<span class="token punctuation">)</span> </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div>`,44)]))}const c=n(p,[["render",o],["__file","index.html.vue"]]),r=JSON.parse('{"path":"/researcher/data-cleaning/","title":"Data Cleaning","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"General Guidelines","slug":"general-guidelines","link":"#general-guidelines","children":[]},{"level":2,"title":"Trial-level","slug":"trial-level","link":"#trial-level","children":[]},{"level":2,"title":"Run-level","slug":"run-level","link":"#run-level","children":[]},{"level":2,"title":"BigQuery Demographics","slug":"bigquery-demographics","link":"#bigquery-demographics","children":[]}],"git":{"updatedTime":1768008200000,"contributors":[{"name":"Kelly Wentzlof","username":"Kelly Wentzlof","email":"159967652+kellywentz@users.noreply.github.com","commits":2,"url":"https://github.com/Kelly Wentzlof"},{"name":"Emily Arteaga-Garcia","username":"Emily Arteaga-Garcia","email":"62304493+Emily-ejag@users.noreply.github.com","commits":3,"url":"https://github.com/Emily Arteaga-Garcia"}]},"filePathRelative":"researcher/data-cleaning/README.md"}');export{c as comp,r as data};
