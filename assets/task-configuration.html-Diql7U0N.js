import{_ as l,c as r,d as n,e,a,b as t,f as c,r as p,o as d}from"./app-ZiMnF_K1.js";const u={};function k(v,s){const i=p("Mermaid"),o=p("RouteLink");return d(),r("div",null,[s[3]||(s[3]=n('<h1 id="roar-task-configuration-and-variant-system-technical-specification" tabindex="-1"><a class="header-anchor" href="#roar-task-configuration-and-variant-system-technical-specification"><span>ROAR Task Configuration and Variant System: Technical Specification</span></a></h1><h2 id="purpose-and-scope" tabindex="-1"><a class="header-anchor" href="#purpose-and-scope"><span>Purpose and Scope</span></a></h2><p>ROAR supports configurable tasks used in assessments. This document defines the technical specification for how researchers interact with configurable ROAR tasks, including:</p><ul><li>Creating and referencing <strong>variants</strong> (parameter configurations)</li><li>Versioning <strong>tasks</strong></li><li>Supporting a flexible yet reproducible <strong>dev mode</strong></li><li>Executing and logging <strong>task runs</strong></li></ul><p>This spec ensures consistency, auditability, and scalability across both development and production contexts.</p><h2 id="system-overview" tabindex="-1"><a class="header-anchor" href="#system-overview"><span>System Overview</span></a></h2><p>The ROAR task system consists of the following components:</p><ul><li><p><strong>Tasks</strong>: Assessment units with parameterizable behavior</p><p>A task is a unit of assessment content and logic (e.g., &quot;ROAR Word&quot;). Tasks are versioned to allow for backwards-compatible and breaking changes.</p></li><li><p><strong>Task Versions</strong>: Versioned logic and default handling per task</p><p>A specific, versioned implementation of a task (e.g., v1.2.0). Task versions define default parameter values and behavior. Changes to logic, scoring, or parameter handling result in a new task version.</p></li><li><p><strong>Variants</strong>: Immutable parameter sets identified by a stable <code>variant_id</code></p><p>A variant is a unique, immutable configuration of a task&#39;s parameters. It is identified by a variant ID, which acts like a DOI. Once created, it will always refer to the same parameter set.</p></li><li><p><strong>Variant Status</strong>: <code>dev</code>, <code>published</code>, or <code>deprecated</code></p><p>A variant can be in one of three states: <code>dev</code>, <code>published</code>, or <code>deprecated</code>. The <code>dev</code> state indicates that the variant is in development and is not yet ready for production use. Dev variants can be edited. Once published, variants are immutable. The <code>published</code> state indicates that the variant is ready for production use and is available for use in assessments. The <code>deprecated</code> state indicates that the variant is no longer recommended for use in assessments but is preserved for historical reproducibility or auditability.</p></li><li><p><strong>Task Bundles</strong>: A grouping of curated variants under a reusable identifier (e.g., &quot;ROAR Core Four&quot; for batch administration).</p></li><li><p><strong>Task Spec</strong>: <code>{ variant_id, task_version }</code> — uniquely defines runtime behavior</p><p>A Task Spec is the pair <code>{ variant_id, task_version }</code>. This combination fully determines the behavior of a task run, including default parameters, logic, and scoring. It is important to realize that the variant_id is not tied to any specific task version. The same variant_id may be used with different task versions, and it is the combination of variant_id and task_version — the Task Spec — that determines the full behavior of a task run.</p></li><li><p><strong>Runs</strong>: Executions of a task spec (i.e., a specific <code>variant_id</code> and <code>task_version</code>)</p><p>A run is a specific instance of a student or researcher interacting with a task. Every run references a variant_id and a task_version_id, allowing the exact task behavior to be reconstructed from the database.</p></li></ul><h3 id="component-flow-diagrams" tabindex="-1"><a class="header-anchor" href="#component-flow-diagrams"><span>Component Flow Diagrams</span></a></h3><h4 id="researcher-task-development" tabindex="-1"><a class="header-anchor" href="#researcher-task-development"><span>Researcher task development</span></a></h4>',10)),e(i,{id:"mermaid-101",code:"eJxtUEsKwjAQ3XuKdwGvoAvdFFxIUTfBxWgGW9omZZIUCj28SWMLBVeTN+/Dy3yE+gq38w64F6pkxyTviiWiJ/b7A07C5PlBUpPxKiNYAevag6B5wJDJZ8zYqGf/9GNRnCdcKJh3VQaj8isGSDDJuDKz6WJtE3qVx5IfE2ZlXiZZrGvbgVPtNNGTUMeexSXhsk3KG7mmZNKjKhx8BIhF9XhMupXLfUd2E67h1dauUlexnY0fXip4iz5TrP94jZ22J9h9AX7yeLM="}),s[4]||(s[4]=a("h4",{id:"participant-task-execution",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#participant-task-execution"},[a("span",null,"Participant task execution")])],-1)),e(i,{id:"mermaid-105",code:"eJxVjs0KgzAQhO99ir0XX6FQsAfBQ5G2lyCy6KJBm0iysT348M2PCj1tdvLtzPQG5wEe+QngWYg7GlZk/LOGLLvA1VrZqxcaiYpF2gBhSQKwBsuuI8W29gZ/dLxfd7LIVyjRqXaonIoxspVz+JmiShaMU8HkoKJBqfXoZpHGkVvkkUxiwCqyelpIbBNmNPgmJhN77Wogb19qHZPYJjDaMTD7nkJ7n9iHRvCRPOy5jezgHC+axVtL7Qv/AFNWbvc="}),s[5]||(s[5]=n(`<h2 id="runtime-behavior-by-mode" tabindex="-1"><a class="header-anchor" href="#runtime-behavior-by-mode"><span>Runtime Behavior by Mode</span></a></h2><h3 id="published-mode" tabindex="-1"><a class="header-anchor" href="#published-mode"><span>Published Mode</span></a></h3><ul><li>Partner specifies a known <code>variant_id</code></li><li>System fetches parameter set from <code>variant_parameters</code></li><li>Task version defaults to the version pinned in the ROAR-dashboard dependencies (if task is launched from the dashboard) or the latest stable release (if task is launched as a standalone web application).</li><li>Runtime merges parameters with task version&#39;s defaults</li><li>Run is executed and logged with <code>variant_id</code>, <code>task_version_id</code></li></ul><h3 id="dev-mode" tabindex="-1"><a class="header-anchor" href="#dev-mode"><span>Dev Mode</span></a></h3><ul><li>Researcher creates a new variant with <code>status = &quot;dev&quot;</code> and provides a custom parameter set</li><li>Variants with <code>status = &quot;dev&quot;</code> are not shown in public researcher dashboards or included in standard reporting or analytics views. This ensures that only validated, production-ready variants are visible for data analysis or deployment purposes.</li><li>Researcher develops and tests the task using the dev variant</li><li>Researcher edit the dev variant as needed.</li><li>When it is ready for production, the researcher toggles <code>status = &quot;published&quot;</code> and adds a name/description.</li><li>The variant is now available for use in assessments.</li></ul><h2 id="edge-cases-and-error-handling" tabindex="-1"><a class="header-anchor" href="#edge-cases-and-error-handling"><span>Edge Cases and Error Handling</span></a></h2><table><thead><tr><th>Scenario</th><th>Expected Behavior</th></tr></thead><tbody><tr><td>Missing <code>variant_id</code> in published mode</td><td>400 error with message &quot;variant_id is required&quot;</td></tr><tr><td>Missing parameter value</td><td>Task resolves using defaults; log warning</td></tr><tr><td>Unknown parameter or invalid value in production</td><td>Task throws error and halts execution</td></tr><tr><td>Attempt to publish a dev variant with identical parameters to existing published one</td><td>Deduplicate by comparing canonical param hash</td></tr><tr><td>Attempt to promote already published variant</td><td>No-op; return existing variant info</td></tr><tr><td>Running a dev or deprecated variant in production</td><td>Reject request with 400 or 403 error. Dev variants are not permitted in production.</td></tr></tbody></table><h2 id="design-rationale" tabindex="-1"><a class="header-anchor" href="#design-rationale"><span>Design Rationale</span></a></h2><ul><li><strong>Separation of variant and version</strong> allows stable IDs while supporting evolving task logic</li><li><strong>Variant ID as immutable key</strong> ensures reproducibility and clean version control</li><li><strong>Dev variants stored as real variants</strong> avoids custom logic for freeform runs, simplifying the schema</li><li><strong>Task Spec abstraction</strong> clearly captures full execution context for a run</li><li><strong>Use of a status field</strong> to differentiate between published and dev variants allows for future lifecycle states.</li></ul><h2 id="sql-schema" tabindex="-1"><a class="header-anchor" href="#sql-schema"><span>SQL Schema</span></a></h2><h3 id="tasks" tabindex="-1"><a class="header-anchor" href="#tasks"><span><code>tasks</code></span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tasks <span class="token punctuation">(</span></span>
<span class="line">  id UUID <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">DEFAULT</span> gen_random_uuid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  slug <span class="token keyword">TEXT</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">  display_name <span class="token keyword">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">  description <span class="token keyword">TEXT</span><span class="token punctuation">,</span></span>
<span class="line">  created_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  updated_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  deleted_at <span class="token keyword">TIMESTAMP</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="task-versions" tabindex="-1"><a class="header-anchor" href="#task-versions"><span><code>task_versions</code></span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> task_versions <span class="token punctuation">(</span></span>
<span class="line">  id UUID <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">DEFAULT</span> gen_random_uuid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  task_id UUID <span class="token keyword">REFERENCES</span> tasks<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">,</span></span>
<span class="line">  version <span class="token keyword">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">  description <span class="token keyword">TEXT</span><span class="token punctuation">,</span></span>
<span class="line">  created_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  updated_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  deleted_at <span class="token keyword">TIMESTAMP</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token keyword">UNIQUE</span><span class="token punctuation">(</span>task_id<span class="token punctuation">,</span> version<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="variants" tabindex="-1"><a class="header-anchor" href="#variants"><span><code>variants</code></span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> variants <span class="token punctuation">(</span></span>
<span class="line">  id UUID <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">DEFAULT</span> gen_random_uuid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  task_id UUID <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">REFERENCES</span> tasks<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">,</span></span>
<span class="line">  task_slug <span class="token keyword">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">REFERENCES</span> tasks<span class="token punctuation">(</span>slug<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  name <span class="token keyword">TEXT</span><span class="token punctuation">,</span></span>
<span class="line">  description <span class="token keyword">TEXT</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token keyword">status</span> <span class="token keyword">TEXT</span> <span class="token keyword">CHECK</span> <span class="token punctuation">(</span><span class="token keyword">status</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">&#39;dev&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;published&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;deprecated&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;dev&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  created_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  updated_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  deleted_at <span class="token keyword">TIMESTAMP</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="variant-parameters" tabindex="-1"><a class="header-anchor" href="#variant-parameters"><span><code>variant_parameters</code></span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> variant_parameters <span class="token punctuation">(</span></span>
<span class="line">  id UUID <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">DEFAULT</span> gen_random_uuid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  variant_id UUID <span class="token keyword">REFERENCES</span> variants<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">,</span></span>
<span class="line">  name <span class="token keyword">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token keyword">value</span> JSONB <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token keyword">type</span> <span class="token keyword">TEXT</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token keyword">UNIQUE</span><span class="token punctuation">(</span>variant_id<span class="token punctuation">,</span> name<span class="token punctuation">)</span></span>
<span class="line">  created_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  updated_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  deleted_at <span class="token keyword">TIMESTAMP</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="task-bundles" tabindex="-1"><a class="header-anchor" href="#task-bundles"><span><code>task_bundles</code></span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> task_bundles <span class="token punctuation">(</span></span>
<span class="line">  id UUID <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">DEFAULT</span> gen_random_uuid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  slug <span class="token keyword">TEXT</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">  name <span class="token keyword">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">  description <span class="token keyword">TEXT</span><span class="token punctuation">,</span></span>
<span class="line">  created_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  updated_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  deleted_at <span class="token keyword">TIMESTAMP</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="task-bundle-variants" tabindex="-1"><a class="header-anchor" href="#task-bundle-variants"><span><code>task_bundle_variants</code></span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> task_bundle_variants <span class="token punctuation">(</span></span>
<span class="line">  id UUID <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">DEFAULT</span> gen_random_uuid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  task_bundle_id UUID <span class="token keyword">REFERENCES</span> task_bundles<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">,</span></span>
<span class="line">  variant_id UUID <span class="token keyword">REFERENCES</span> variants<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">,</span></span>
<span class="line">  sort_order <span class="token keyword">INT</span><span class="token punctuation">,</span></span>
<span class="line">  created_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  updated_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  deleted_at <span class="token keyword">TIMESTAMP</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token keyword">UNIQUE</span><span class="token punctuation">(</span>task_bundle_id<span class="token punctuation">,</span> variant_id<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="runs" tabindex="-1"><a class="header-anchor" href="#runs"><span><code>runs</code></span></a></h3>`,23)),a("p",null,[s[1]||(s[1]=t("See the ")),e(o,{to:"/developer/tech-specs/backend/assessment-execution.html"},{default:c(()=>s[0]||(s[0]=[t("assessment-execution")])),_:1}),s[2]||(s[2]=t(" section for the full schema."))]),s[6]||(s[6]=n(`<h2 id="api-contract" tabindex="-1"><a class="header-anchor" href="#api-contract"><span>API Contract</span></a></h2><h3 id="get-api-tasks" tabindex="-1"><a class="header-anchor" href="#get-api-tasks"><span><code>GET /api/tasks/</code></span></a></h3><p>Returns metadata for all available tasks.</p><h3 id="get-api-tasks-task-slug" tabindex="-1"><a class="header-anchor" href="#get-api-tasks-task-slug"><span><code>GET /api/tasks/{task_slug}</code></span></a></h3><p>Returns metadata for a specific task.</p><h3 id="get-api-tasks-task-slug-versions" tabindex="-1"><a class="header-anchor" href="#get-api-tasks-task-slug-versions"><span><code>GET /api/tasks/{task_slug}/versions</code></span></a></h3><p>Returns metadata for all available versions of a specific task. Dev variants are excluded by default.</p><h3 id="post-api-variants" tabindex="-1"><a class="header-anchor" href="#post-api-variants"><span><code>POST /api/variants</code></span></a></h3><p>Creates a dev variant.</p><div class="language-http line-numbers-mode" data-highlighter="prismjs" data-ext="http" data-title="http"><pre><code><span class="line">POST /api/variants</span>
<span class="line">{</span>
<span class="line">  &quot;task_slug&quot;: &quot;swr&quot;,</span>
<span class="line">  &quot;parameters&quot;: {</span>
<span class="line">    &quot;num_items&quot;: 8,</span>
<span class="line">    &quot;shuffle&quot;: true</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="patch-api-variants-variant-id" tabindex="-1"><a class="header-anchor" href="#patch-api-variants-variant-id"><span><code>PATCH /api/variants/{variant_id}</code></span></a></h3><p>Edits a dev variant.</p><div class="language-http line-numbers-mode" data-highlighter="prismjs" data-ext="http" data-title="http"><pre><code><span class="line">PATCH /api/variants/{variant_id}</span>
<span class="line">{</span>
<span class="line">  &quot;parameters&quot;: {</span>
<span class="line">    &quot;num_items&quot;: 8,</span>
<span class="line">    &quot;shuffle&quot;: true</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Allowed only if the variant status is <code>&quot;dev&quot;</code>.</p><h3 id="post-api-variants-variant-id-publish" tabindex="-1"><a class="header-anchor" href="#post-api-variants-variant-id-publish"><span><code>POST /api/variants/{variant_id}/publish</code></span></a></h3><p>Promotes a dev variant to published. Freezes the variant parameters and assigns a name and description.</p><div class="language-http line-numbers-mode" data-highlighter="prismjs" data-ext="http" data-title="http"><pre><code><span class="line">POST /api/variants/{variant_id}/publish</span>
<span class="line">{</span>
<span class="line">  &quot;name&quot;: &quot;My Variant&quot;,</span>
<span class="line">  &quot;description&quot;: &quot;My Variant Description&quot;</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="get-api-task-bundles-slug" tabindex="-1"><a class="header-anchor" href="#get-api-task-bundles-slug"><span><code>GET /api/task-bundles/{slug}</code></span></a></h3><p>Returns metadata and ordered variants for a single task package.</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json" data-title="json"><pre><code><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;slug&quot;</span><span class="token operator">:</span> <span class="token string">&quot;core-4&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Core 4 Literacy Tasks&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;The ROAR Core 4 literacy tasks&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;variants&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span> <span class="token property">&quot;variant_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;uuid-1&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;task_slug&quot;</span><span class="token operator">:</span> <span class="token string">&quot;roar-letter&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;sort_order&quot;</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span> <span class="token property">&quot;variant_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;uuid-2&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;task_slug&quot;</span><span class="token operator">:</span> <span class="token string">&quot;roar-phoneme&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;sort_order&quot;</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span> <span class="token property">&quot;variant_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;uuid-3&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;task_slug&quot;</span><span class="token operator">:</span> <span class="token string">&quot;roar-word&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;sort_order&quot;</span><span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span> <span class="token property">&quot;variant_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;uuid-4&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;task_slug&quot;</span><span class="token operator">:</span> <span class="token string">&quot;roar-sentence&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;sort_order&quot;</span><span class="token operator">:</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="migration-plan" tabindex="-1"><a class="header-anchor" href="#migration-plan"><span>Migration Plan</span></a></h2><ul><li>Migrate existing Firestore variants into the <code>variants</code> and <code>variant_parameters</code> tables</li><li>Migrate the <code>registered</code> field to the <code>status</code> field.</li><li>Deprecate the <code>registered</code> field for tasks. Instead tasks should be considered &quot;published&quot; if they have any published variants.</li><li>Dev-mode Firestore runs can be replayed into SQL by minting variants</li><li>Legacy tasks may require shimming in the API to handle missing variant metadata</li><li>After migration, new runs must go through the SQL-backed system</li></ul><h2 id="summary" tabindex="-1"><a class="header-anchor" href="#summary"><span>Summary</span></a></h2><p>This spec provides a consistent, extensible, and reproducible system for managing task configuration and execution in ROAR. The abstraction of a <strong>Task Spec = { variant ID, task version }</strong> enables clarity for researchers, traceability for engineers, and scalability for the system.</p>`,24))])}const m=l(u,[["render",k],["__file","task-configuration.html.vue"]]),b=JSON.parse('{"path":"/developer/tech-specs/backend/task-configuration.html","title":"ROAR Task Configuration and Variant System: Technical Specification","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"Purpose and Scope","slug":"purpose-and-scope","link":"#purpose-and-scope","children":[]},{"level":2,"title":"System Overview","slug":"system-overview","link":"#system-overview","children":[{"level":3,"title":"Component Flow Diagrams","slug":"component-flow-diagrams","link":"#component-flow-diagrams","children":[]}]},{"level":2,"title":"Runtime Behavior by Mode","slug":"runtime-behavior-by-mode","link":"#runtime-behavior-by-mode","children":[{"level":3,"title":"Published Mode","slug":"published-mode","link":"#published-mode","children":[]},{"level":3,"title":"Dev Mode","slug":"dev-mode","link":"#dev-mode","children":[]}]},{"level":2,"title":"Edge Cases and Error Handling","slug":"edge-cases-and-error-handling","link":"#edge-cases-and-error-handling","children":[]},{"level":2,"title":"Design Rationale","slug":"design-rationale","link":"#design-rationale","children":[]},{"level":2,"title":"SQL Schema","slug":"sql-schema","link":"#sql-schema","children":[{"level":3,"title":"tasks","slug":"tasks","link":"#tasks","children":[]},{"level":3,"title":"task_versions","slug":"task-versions","link":"#task-versions","children":[]},{"level":3,"title":"variants","slug":"variants","link":"#variants","children":[]},{"level":3,"title":"variant_parameters","slug":"variant-parameters","link":"#variant-parameters","children":[]},{"level":3,"title":"task_bundles","slug":"task-bundles","link":"#task-bundles","children":[]},{"level":3,"title":"task_bundle_variants","slug":"task-bundle-variants","link":"#task-bundle-variants","children":[]},{"level":3,"title":"runs","slug":"runs","link":"#runs","children":[]}]},{"level":2,"title":"API Contract","slug":"api-contract","link":"#api-contract","children":[{"level":3,"title":"GET /api/tasks/","slug":"get-api-tasks","link":"#get-api-tasks","children":[]},{"level":3,"title":"GET /api/tasks/{task_slug}","slug":"get-api-tasks-task-slug","link":"#get-api-tasks-task-slug","children":[]},{"level":3,"title":"GET /api/tasks/{task_slug}/versions","slug":"get-api-tasks-task-slug-versions","link":"#get-api-tasks-task-slug-versions","children":[]},{"level":3,"title":"POST /api/variants","slug":"post-api-variants","link":"#post-api-variants","children":[]},{"level":3,"title":"PATCH /api/variants/{variant_id}","slug":"patch-api-variants-variant-id","link":"#patch-api-variants-variant-id","children":[]},{"level":3,"title":"POST /api/variants/{variant_id}/publish","slug":"post-api-variants-variant-id-publish","link":"#post-api-variants-variant-id-publish","children":[]},{"level":3,"title":"GET /api/task-bundles/{slug}","slug":"get-api-task-bundles-slug","link":"#get-api-task-bundles-slug","children":[]}]},{"level":2,"title":"Migration Plan","slug":"migration-plan","link":"#migration-plan","children":[]},{"level":2,"title":"Summary","slug":"summary","link":"#summary","children":[]}],"git":{"updatedTime":1751819643000,"contributors":[{"name":"Adam Richie-Halford","username":"Adam Richie-Halford","email":"richiehalford@gmail.com","commits":2,"url":"https://github.com/Adam Richie-Halford"}]},"filePathRelative":"developer/tech-specs/backend/task-configuration.md"}');export{m as comp,b as data};
