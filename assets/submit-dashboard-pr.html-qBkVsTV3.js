import{_ as n,c as a,d as e,o as p}from"./app-CJ7yTU5J.js";const t={};function l(i,s){return p(),a("div",null,s[0]||(s[0]=[e(`<h1 id="submit-dashboard-pr-yml" tabindex="-1"><a class="header-anchor" href="#submit-dashboard-pr-yml"><span>submit-dashboard-pr.yml</span></a></h1><p>This GitHub Actions workflow submits a pull request to the ROAR-dashboard repository to update the version of the app package. The workflow is triggered when the <code>Publish, Release, and Deploy</code> workflow completes successfully. This example uses <code>roar-sre</code> as the package to update, but the workflow can be modified to update any package in the dashboard repository.</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">name</span><span class="token punctuation">:</span> Update dependency version in ROAR<span class="token punctuation">-</span>dashboard</span>
<span class="line"></span>
<span class="line"><span class="token key atrule">on</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">workflow_run</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">workflows</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;Publish, Release, and Deploy&#39;</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token key atrule">types</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> completed</span>
<span class="line"></span>
<span class="line"><span class="token key atrule">jobs</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">update-version</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest</span>
<span class="line"></span>
<span class="line">    <span class="token key atrule">if</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> github.event.workflow_run.conclusion == &#39;success&#39; <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token key atrule">steps</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout the repository</span>
<span class="line">        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2</span>
<span class="line"></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Get the new version</span>
<span class="line">        <span class="token key atrule">id</span><span class="token punctuation">:</span> get_new_version</span>
<span class="line">        <span class="token key atrule">run</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string"></span>
<span class="line">          VERSION=$(jq -r &#39;.version&#39; package.json)</span>
<span class="line">          echo &quot;NEW_VERSION=$VERSION&quot; &gt;&gt; $GITHUB_OUTPUT</span></span>
<span class="line"></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout the target repository</span>
<span class="line">        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2</span>
<span class="line">        <span class="token key atrule">with</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">repository</span><span class="token punctuation">:</span> yeatmanlab/roar<span class="token punctuation">-</span>dashboard</span>
<span class="line">          <span class="token key atrule">token</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.DASHBOARD_REPO_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">          <span class="token key atrule">path</span><span class="token punctuation">:</span> dashboard<span class="token punctuation">-</span>repo</span>
<span class="line"></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Update version in package.json</span>
<span class="line">        <span class="token key atrule">run</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string"></span>
<span class="line">          cd dashboard-repo</span>
<span class="line">          NEW_VERSION=\${{ steps.get_new_version.outputs.NEW_VERSION }}</span>
<span class="line">          jq --arg ver &quot;$NEW_VERSION&quot; &#39;.dependencies[&quot;@bdelab/roar-sre&quot;] = $ver&#39; package.json &gt; temp.json &amp;&amp; mv temp.json package.json</span>
<span class="line">          npm i</span></span>
<span class="line"></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Create Pull Request</span>
<span class="line">        <span class="token key atrule">uses</span><span class="token punctuation">:</span> peter<span class="token punctuation">-</span>evans/create<span class="token punctuation">-</span>pull<span class="token punctuation">-</span>request@v4</span>
<span class="line">        <span class="token key atrule">with</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">path</span><span class="token punctuation">:</span> dashboard<span class="token punctuation">-</span>repo</span>
<span class="line">          <span class="token key atrule">token</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.DASHBOARD_REPO_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">          <span class="token key atrule">commit-message</span><span class="token punctuation">:</span> Update SRE version to $<span class="token punctuation">{</span><span class="token punctuation">{</span> steps.get_new_version.outputs.NEW_VERSION <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">          <span class="token key atrule">branch</span><span class="token punctuation">:</span> dep/update<span class="token punctuation">-</span>sre<span class="token punctuation">-</span>$<span class="token punctuation">{</span><span class="token punctuation">{</span> steps.get_new_version.outputs.NEW_VERSION <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">          <span class="token key atrule">base</span><span class="token punctuation">:</span> main</span>
<span class="line">          <span class="token key atrule">title</span><span class="token punctuation">:</span> Update SRE version to $<span class="token punctuation">{</span><span class="token punctuation">{</span> steps.get_new_version.outputs.NEW_VERSION <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">          <span class="token key atrule">body</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string"></span>
<span class="line">            This PR updates the version of \`@bdelab/roar-sre\` to \${{ steps.get_new_version.outputs.NEW_VERSION }}.</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3)]))}const o=n(t,[["render",l],["__file","submit-dashboard-pr.html.vue"]]),u=JSON.parse('{"path":"/developer/github-actions/apps/submit-dashboard-pr.html","title":"submit-dashboard-pr.yml","lang":"en-US","frontmatter":{},"headers":[],"git":{"updatedTime":1743546779000,"contributors":[{"name":"Elijah Kelly","username":"Elijah Kelly","email":"kellyel@stanford.edu","commits":1,"url":"https://github.com/Elijah Kelly"},{"name":"Kyle","username":"Kyle","email":"ksmontville@gmail.com","commits":1,"url":"https://github.com/Kyle"}]},"filePathRelative":"developer/github-actions/apps/submit-dashboard-pr.md"}');export{o as comp,u as data};
