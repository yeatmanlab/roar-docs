import{_ as n,r as t,o as a,c as i,a as e,b as o,d as r,e as l}from"./app-D-yPTP-A.js";const c={},d=e("h1",{id:"removefromadminclaims",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#removefromadminclaims"},[e("span",null,"removefromadminclaims()")])],-1),p={id:"removefromadminclaims-1",tabindex:"-1"},u={class:"header-anchor",href:"#removefromadminclaims-1"},h={href:"https://github.com/yeatmanlab/roar-firebase-functions/blob/e784650492722d24069aa9b0704d1873ea5dafee/gse-roar-admin/functions/src/index.ts#L135",target:"_blank",rel:"noopener noreferrer"},m=l(`<h3 id="function-name" tabindex="-1"><a class="header-anchor" href="#function-name"><span>Function Name</span></a></h3><p><code>removefromadminclaims</code></p><h3 id="trigger" tabindex="-1"><a class="header-anchor" href="#trigger"><span>Trigger</span></a></h3><p>This Cloud Function is triggered by an <code>onCall</code> event, meaning it is directly invoked by client-side applications. The function is designed to be accessed through a secure, authenticated API call.</p><h3 id="inputs" tabindex="-1"><a class="header-anchor" href="#inputs"><span>Inputs</span></a></h3><p>The function expects a JSON payload containing several parameters:</p><ul><li><strong>requesterUid</strong> (string): The UID of the user who is making the request. This UID is extracted from the authenticated session (<code>request.auth.uid</code>).</li><li><strong>targetUid</strong> (string): The UID of the user whose administrative claims are being updated.</li><li><strong>districtId</strong> (string): The identifier for the district from which the user&#39;s claims are to be removed.</li><li><strong>schoolId</strong> (string): The identifier for the school from which the user&#39;s claims are to be removed.</li><li><strong>classId</strong> (string): The identifier for the class from which the user&#39;s claims are to be removed.</li><li><strong>familyId</strong> (string): The identifier for the family from which the user&#39;s claims are to be removed.</li><li><strong>groupId</strong> (string): The identifier for the group from which the user&#39;s claims are to be removed.</li><li><strong>action</strong> (string): A constant value set to &quot;remove&quot;, indicating the nature of the operation.</li></ul><p>Example JSON input:</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;requesterUid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin123&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;targetUid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user456&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;districtId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dist001&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;schoolId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sch002&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;classId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;class003&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;familyId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fam004&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;groupId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;grp005&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;action&quot;</span><span class="token operator">:</span> <span class="token string">&quot;remove&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="outputs" tabindex="-1"><a class="header-anchor" href="#outputs"><span>Outputs</span></a></h3><p>The function returns the result of the <code>appendOrRemoveAdminOrgs</code> function, which handles the actual update to the database. This result could be:</p><ul><li>A success message indicating that the claims have been successfully removed.</li><li>An error message or object if the operation fails, which may include details such as invalid UIDs, permission issues, or database errors.</li></ul><h3 id="description" tabindex="-1"><a class="header-anchor" href="#description"><span>Description</span></a></h3><p>The <code>removefromadminclaims</code> function is responsible for removing specific administrative claims associated with organizational affiliations (e.g., districts, schools, classes) from a specified user&#39;s profile. This is part of managing user access within the system, ensuring that users have appropriate rights that reflect their current roles or affiliations.</p><h3 id="error-handling" tabindex="-1"><a class="header-anchor" href="#error-handling"><span>Error Handling</span></a></h3><p>Effective error handling should be implemented to manage and log various failure scenarios, such as:</p><ul><li>Non-existent UIDs for the requester or target.</li><li>Database operations failures, such as connection issues or transaction failures.</li><li>Permission errors if the requester does not have the right to modify administrative claims.</li><li>Handling unexpected input or incorrect data formats.</li></ul><p>Errors should be logged and, where appropriate, detailed error information should be returned to the caller to facilitate troubleshooting while ensuring security best practices.</p><h3 id="security-considerations" tabindex="-1"><a class="header-anchor" href="#security-considerations"><span>Security Considerations</span></a></h3><ul><li><strong>Authentication</strong>: The function verifies that the request is made by an authenticated user.</li><li><strong>Authorization</strong>: It should be verified that the requester has the appropriate rights to modify administrative claims, particularly if they are removing claims for another user.</li><li><strong>Data Validation</strong>: The function should validate the input data to ensure all IDs are valid and properly formatted before attempting operations on the database.</li></ul><h3 id="deployment" tabindex="-1"><a class="header-anchor" href="#deployment"><span>Deployment</span></a></h3><p>This function is deployed automatically using GitHub actions, whenever changes are merged into the <code>main</code> branch.</p>`,22);function g(f,v){const s=t("ExternalLinkIcon");return a(),i("div",null,[d,e("h4",p,[e("a",u,[e("span",null,[e("a",h,[o("removeFromAdminClaims"),r(s)])])])]),m])}const k=n(c,[["render",g],["__file","remove-from-admin-claims.html.vue"]]),q=JSON.parse('{"path":"/cloud-functions/gse-roar-admin/remove-from-admin-claims.html","title":"removefromadminclaims()","lang":"en-US","frontmatter":{},"headers":[{"level":3,"title":"Function Name","slug":"function-name","link":"#function-name","children":[]},{"level":3,"title":"Trigger","slug":"trigger","link":"#trigger","children":[]},{"level":3,"title":"Inputs","slug":"inputs","link":"#inputs","children":[]},{"level":3,"title":"Outputs","slug":"outputs","link":"#outputs","children":[]},{"level":3,"title":"Description","slug":"description","link":"#description","children":[]},{"level":3,"title":"Error Handling","slug":"error-handling","link":"#error-handling","children":[]},{"level":3,"title":"Security Considerations","slug":"security-considerations","link":"#security-considerations","children":[]},{"level":3,"title":"Deployment","slug":"deployment","link":"#deployment","children":[]}],"git":{"updatedTime":1714409897000,"contributors":[{"name":"Kyle","email":"ksmontville@gmail.com","commits":1},{"name":"Kyle Montville","email":"kmontvil@stanford.edu","commits":1}]},"filePathRelative":"cloud-functions/gse-roar-admin/remove-from-admin-claims.md"}');export{k as comp,q as data};
